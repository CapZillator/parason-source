import React, { useContext } from 'react';
import { AppContext } from '../store/context';
import { moonriseSetDayduration } from '../Lib';
import getLangPack from '../LangPack';
import '../styles/Chart.scss';

function MoonChart(props: any) {
    const { state, dispatch } = useContext(AppContext);
    const lang = getLangPack(state.lang.code);

    let rise = props.moonrise ? props.moonrise: 0;
    let set = props.moonset ? props.moonset: 0;

    let moonrise, moonset, moonDur;
    
    if (state.weather.data){//Получаем астрономические данные
        const astronomy = moonriseSetDayduration(rise, set, lang.fullCode);
        moonDur = astronomy.duration;
        if (moonDur !== '∞'){
            moonrise = astronomy.moonrise;
            moonset = astronomy.moonset;
        };
    };
    return (
        <div className="Sunchart-wrapper">
            <svg
                width={200}
                height={80}
                viewBox="0 0 52.917 21.167"
                className="Astro"
            >
                <path className="Astro-chart-el" transform="matrix(.26459 0 0 .26459 -.00025 0)" d="m40.574 19.059c-2.3128 0.033259-4.6325 0.57217-6.7988 1.6426-6.8691 3.3941-10.466 11.053-8.6973 18.514 0.15181 0.64016 0.73276 2.1277 1.291 3.3066 0.82801 1.7486 2.1067 3.3864 3.6465 4.7734h2.3535c-0.6665-0.4814-1.3068-1.0173-1.9102-1.6191-5.8063-5.7915-5.8159-14.812-0.023437-20.686 2.0426-2.0712 4.4073-3.4123 7.1562-4.0586 0.84813-0.19948 1.8906-0.29868 2.9766-0.30469 1.8099-0.009826 3.7389 0.23817 5.084 0.70898 4.1818 1.4636 7.6373 4.9315 9.1914 9.2246 0.67074 1.853 0.8966 5.5528 0.47266 7.748-0.68905 3.568-2.932 6.8202-5.9414 8.9863h2.459c1.4046-1.2737 2.5816-2.7973 3.4297-4.5293 1.3593-2.776 1.8073-4.6229 1.8027-7.4219-0.007181-4.5694-1.5388-8.2513-4.7793-11.488-3.089-3.0856-7.1413-4.7365-11.25-4.7969-0.15409-0.002223-0.30868-0.00223-0.46289 0zm6.3926 4.5742c-0.33615-0.015117-0.56107 0.14422-0.74414 0.48633-0.229 0.42791-0.15093 0.63423 0.47656 1.2617 0.82835 0.82835 1.2236 0.91323 1.9062 0.41406 0.6196-0.45306 0.3211-1.3243-0.61914-1.8105-0.42943-0.22204-0.75809-0.33977-1.0195-0.35156zm-13.854 1.002c-0.11082-4.6e-5 -0.22094 0.09617-0.41211 0.28711-0.227 0.227-0.34373 0.59175-0.25977 0.81055 0.083957 0.21883 0.38577 0.39844 0.67188 0.39844 0.69169 1.2e-5 0.92769-0.6934 0.41211-1.209-0.1911-0.19109-0.30128-0.28711-0.41211-0.28711zm16.873 0.48633c-0.11732 1.32e-4 -0.14822 0.17085-0.068359 0.37891s0.31714 0.37696 0.52734 0.37695c0.31113 1.5e-5 0.32393-0.069006 0.06836-0.37695-0.17268-0.20806-0.40997-0.3789-0.52734-0.37891zm-10.377 0.57031c-0.26196 0.008315-0.52814 0.097301-0.79102 0.26953-0.3281 0.21498-0.82137 0.33135-1.0957 0.25976-0.48838-0.12771-1.3301 0.4645-1.3301 0.93555 3e-6 0.1288 0.22651 0.46088 0.50391 0.73828 0.27738 0.27741 0.50391 0.59334 0.50391 0.70117 1.9e-5 0.10783 0.1767 0.4476 0.39258 0.75586 0.49341 0.70446 1.4773 0.72663 2.5762 0.056641 1.2657-0.7717 1.5048-1.5309 0.82617-2.6289-0.45363-0.73398-1.0096-1.1063-1.5859-1.0879zm5.6406 1.4785c-0.44744-0.013228-0.9711 0.1996-1.752 0.65234-1.4641 0.84898-1.7925 1.2531-1.8027 2.2227-0.012472 1.1807 0.64444 1.949 1.5059 1.7598 0.39807-0.087495 0.78028-0.038755 0.87305 0.11133 0.32753 0.52996 0.87951 0.15913 2.0059-1.3477 0.9041-1.2095 0.96314-2.3146 0.16016-2.9648-0.34136-0.27643-0.64221-0.42342-0.99023-0.43359zm-12.748 0.25195c-0.37025 0.004913-0.74609 0.1145-1.0957 0.35938-0.89866 0.62945-1.1864 1.357-0.68359 1.7246 0.25128 0.18376 0.38577 0.55892 0.33398 0.92578-0.072721 0.51522-0.23091 0.61919-0.96875 0.63476-0.87605 0.01852-0.88157 0.027077-0.81445 1.0723 0.083998 1.3082-0.28565 1.3543-1.0098 0.12695l-0.54688-0.92578-0.19531 0.73438c-0.39421 1.474-0.53717 3.6387-0.24023 3.6387 1.1208 0 1.8366 2.6792 0.78906 2.9531-0.62603 0.16384-0.62573 0.21607 0.029297 1.9277 0.39015 1.0195 0.67957 1.4166 1.0723 1.4727 0.32939 0.046979 0.5672 0.28952 0.61523 0.62695 0.053438 0.37534 0.31517 0.60389 0.82031 0.71484 0.40765 0.089536 0.74023 0.30142 0.74023 0.4707-3e-6 0.16932 0.12757 0.43425 0.2832 0.58984 0.45439 0.45439 1.0376 0.075117 0.91016-0.5918-0.098361-0.51453-0.036-0.57055 0.48633-0.43945 0.86193 0.21634 2.0662-0.36445 2.502-1.207 0.30436-0.58856 0.4614-0.67883 0.83203-0.48047 0.32443 0.17363 0.61403 0.13359 1-0.13672 0.69856-0.48929 0.69324-1.2269-0.011719-1.7207-0.4921-0.34469-0.61831-0.34727-1.125-0.015625-0.5219 0.34197-0.59516 0.33192-0.8418-0.12891-0.21256-0.39718-0.19196-0.50586 0.097657-0.50586 0.60731 3e-6 1.8896-1.4729 2.0566-2.3633 0.3414-1.8197-1.2522-3.6855-3.1504-3.6875-0.67668-7.07e-4 -0.80178-0.067387-0.56641-0.30273 0.16644-0.16645 0.30612-0.59163 0.31055-0.94531 0.004385-0.35368 0.17333-0.86358 0.37695-1.1328 1.1052-1.4611-0.40146-3.4101-2.0059-3.3887zm17.27 0.060547c-0.1892-0.010961-0.3867 0.058825-0.6875 0.20312-1.4009 0.67173-1.5549 2.5598-0.25976 3.1855 0.716 0.34593 0.7797 0.34858 1.5527 0.054687 1.3135-0.49938 1.333-2.3137 0.035156-3.1641-0.27016-0.17703-0.45141-0.26841-0.64062-0.2793zm-10.984 3.9434c-0.68124 4e-6 -0.99406 0.35521-0.78711 0.89453 0.1813 0.47253 1.0157 0.473 1.4082 0 0.40442-0.48728 0.1221-0.89453-0.62109-0.89453zm9.709 1.7656c-0.64161-1.1e-5 -0.92098 0.63378-0.50195 1.1387 0.17121 0.20628 0.39722 0.37305 0.50195 0.37305 0.36736 1.1e-5 0.81288-0.75323 0.66797-1.1309-0.08051-0.2098-0.38186-0.38086-0.66797-0.38086zm-17.338 0.75586c0.67856 7e-6 0.95562 0.099842 0.88281 0.31641-0.05828 0.17336 0.22672 0.45497 0.63281 0.62695 0.40609 0.172 0.79373 0.53091 0.86328 0.79688 0.069573 0.26596 0.34355 0.54037 0.60742 0.60938 0.62651 0.16384 0.87373 0.8367 0.48047 1.3105-0.39445 0.47525-1.1723 0.48507-1.4355 0.017578-0.11092-0.19691-0.59854-0.39565-1.084-0.44141-0.77957-0.073473-0.92195-0.20087-1.2109-1.0859-0.18005-0.5512-0.49159-1.1853-0.69336-1.4082-0.48999-0.54143-0.23148-0.74219 0.95703-0.74219zm0.85742 5.0527c0.18722 0.001799 0.37143 0.08794 0.48242 0.26758 0.093942 0.15201 0.016026 0.43137-0.17383 0.62109-0.43747 0.43733-1.1095 0.066124-0.89453-0.49414 0.099679-0.2598 0.34523-0.39682 0.58594-0.39453zm8 1c-0.77922 4e-6 -2.1113 1.2677-2.1113 2.0098 4e-6 0.29438 0.27867 0.81385 0.61914 1.1543 0.75452 0.75453 2.0963 0.8264 2.9238 0.15625 1.2296-0.99564 0.22743-3.3203-1.4316-3.3203zm-3.5684 4.1797c-0.092752-0.006048-0.18749 0.002883-0.28125 0.027343-0.44227 0.11565-0.99421 1.0022-0.74219 1.1914 0.047315 0.035526 0.36676 0.25408 0.71094 0.48633 0.75315 0.50828 1.025 0.44722 1.2988-0.29297 0.23433-0.63343-0.33717-1.3695-0.98633-1.4121zm7.7617 0.10742c-0.13871-3e-6 -0.25195 0.11325-0.25195 0.25195-4e-6 0.13871 0.11325 0.25195 0.25195 0.25195 0.13871 3e-6 0.25195-0.11325 0.25195-0.25195 3e-6 -0.13871-0.11325-0.25195-0.25195-0.25195z" strokeWidth="0.25218"/>
                <path className="Astro-chart-el" transform="matrix(.26459 0 0 .26459 -.00025 0)" d="m161.03 35.023c-2.3128 0.033259-4.6325 0.57217-6.7988 1.6426-4.41 2.179-7.472 6.1151-8.6309 10.629h1.5293c0.66959-2.2944 1.9232-4.4756 3.7617-6.3398 2.0426-2.0712 4.4073-3.4123 7.1563-4.0586 0.84812-0.19948 1.8906-0.29868 2.9766-0.30469 1.8099-0.009827 3.7389 0.23817 5.084 0.70898 4.1818 1.4636 7.6374 4.9315 9.1914 9.2246 0.08323 0.22992 0.15938 0.48912 0.22851 0.76953h1.541c-0.67055-2.7992-2.0925-5.2434-4.3262-7.4746-3.089-3.0856-7.1413-4.7365-11.25-4.7969-0.15409-0.002223-0.30868-0.00223-0.46289 0zm6.3926 4.5742c-0.33615-0.015118-0.56108 0.14422-0.74415 0.48633-0.22899 0.42791-0.15093 0.63423 0.47657 1.2617 0.82835 0.82835 1.2236 0.91518 1.9062 0.41602 0.6196-0.45306 0.3211-1.3263-0.61914-1.8125-0.42943-0.22204-0.75809-0.33977-1.0195-0.35156zm-13.854 1.002c-0.11081-4.5e-5 -0.22096 0.096171-0.41211 0.28711-0.22699 0.227-0.34371 0.59175-0.25977 0.81055 0.08395 0.21883 0.38578 0.39844 0.67188 0.39844 0.69169 1.1e-5 0.92769-0.6934 0.41211-1.209-0.19109-0.19109-0.30127-0.28711-0.41211-0.28711zm16.873 0.48633c-0.11732 1.32e-4 -0.14822 0.17085-0.06836 0.37891 0.07986 0.20806 0.31714 0.37891 0.52734 0.37891 0.31113 1.5e-5 0.32393-0.070959 0.06836-0.37891-0.17268-0.20806-0.40997-0.3789-0.52734-0.37891zm-10.377 0.57031c-0.26195 0.008315-0.52814 0.097301-0.79101 0.26953-0.3281 0.21498-0.82137 0.3333-1.0957 0.26172-0.48838-0.12771-1.3301 0.4645-1.3301 0.93555 0 0.1288 0.2265 0.46088 0.5039 0.73828 0.27738 0.27741 0.50391 0.59138 0.50391 0.69922 2e-5 0.10783 0.1767 0.44956 0.39258 0.75781 0.49341 0.70446 1.4773 0.72468 2.5762 0.054688 1.2657-0.7717 1.5048-1.5309 0.82617-2.6289-0.45363-0.73398-1.0096-1.1063-1.5859-1.0879zm5.6406 1.4805c-0.44745-0.013228-0.9711 0.1996-1.752 0.65234-1.4641 0.84899-1.7925 1.2531-1.8027 2.2227-0.00557 0.52687 0.12406 0.9694 0.34375 1.2832h3.4356c0.18097-0.21136 0.38197-0.46274 0.60547-0.76172 0.9041-1.2095 0.96313-2.3146 0.16015-2.9648-0.34136-0.27643-0.64221-0.42146-0.99023-0.43164zm-12.748 0.25v0.001953c-0.37024 0.004913-0.74609 0.1145-1.0957 0.35938-0.89866 0.62945-1.1864 1.355-0.6836 1.7227 0.2513 0.18376 0.38577 0.55892 0.33399 0.92578-0.07272 0.51522-0.23089 0.61919-0.96875 0.63477-0.53521 0.011314-0.74506 0.021321-0.8125 0.26367h4.9746c0.06802-0.19946 0.15861-0.38837 0.25781-0.51953 1.1052-1.4611-0.40147-3.4101-2.0059-3.3887zm17.199 0.0625c-0.16858 0.007941-0.35399 0.076862-0.61719 0.20312-1.4009 0.67173-1.5549 2.5598-0.25976 3.1855 0.71599 0.34593 0.77971 0.34858 1.5527 0.054687 1.3135-0.49938 1.333-2.3137 0.03516-3.1641-0.27016-0.17703-0.45141-0.26841-0.64063-0.2793-0.02365-0.00137-0.04623-0.001135-0.07031 0z" strokeWidth="0.25218"/>
                <path className="Astro-chart-el"
                d="M.666 11.178c-.051.06-.03.169.052.25.083.083.197.103.254.046l.807-.807v1.683c0 .09.095.164.213.164s.213-.073.213-.164v-1.682l.07.07.737.736c.057.058.17.037.254-.047.084-.083.105-.197.047-.254l-1.066-1.066-.104-.105-.035-.034a.144.144 0 0 0-.113-.04.146.146 0 0 0-.119.04l-.035.034-.104.105-1.066 1.066-.005.005zM52.396 11.253c.051-.06.029-.169-.052-.25-.083-.083-.197-.103-.254-.046l-.807.807v-1.683c0-.09-.095-.164-.213-.164s-.213.073-.213.164v1.682l-.071-.07-.736-.736c-.057-.058-.171-.037-.255.047-.083.083-.104.197-.046.254l1.205 1.205c.03.03.07.042.113.04a.146.146 0 0 0 .119-.04l.475-.475.73-.73.005-.005z"
                strokeWidth="0.18869"
                />
                <path className="Astro-chart-el"
                d="M19.883 15.252c.077.066.218.038.323-.067.108-.108.135-.255.06-.33l-1.321-1.322 1.321-1.321c.075-.075.048-.223-.06-.33-.108-.109-.255-.136-.33-.06l-1.382 1.38-.18.181a.186.186 0 0 0-.05.147.189.189 0 0 0 .05.153l1.562 1.562a.158.158 0 0 0 .007.007z"
                strokeWidth="0.24458"
                />
                <path className="Astro-chart-el"
                d="M.857 13.262c-.121 0-.218.121-.218.271s.097.27.218.27h20.46c.122 0 .22-.12.22-.27s-.098-.271-.22-.271H5.648z"
                strokeWidth="0.2547"
                />
                <rect className="Astro-chart-el"
                x={27.27}
                y={13.262}
                width={1.066}
                height={0.542}
                rx={0.197}
                ry={0.585}
                strokeWidth="0.065521"
                />
                <rect className="Astro-chart-el"
                x={25.22}
                y={13.262}
                width={1.066}
                height={0.542}
                rx={0.197}
                ry={0.585}
                strokeWidth="0.065521"
                />
                <path className="Astro-chart-el"
                d="M33.673 15.252c-.077.066-.218.038-.323-.067-.108-.108-.135-.255-.06-.33l1.321-1.322-1.321-1.321c-.075-.075-.048-.223.06-.33.108-.109.255-.136.33-.06l1.562 1.561c.038.038.054.09.05.147a.189.189 0 0 1-.05.153l-.18.18-1.382 1.382a.158.158 0 0 1-.007.007z"
                strokeWidth="0.24458"
                />
                <path className="Astro-chart-el"
                d="M32.238 13.262c-.121 0-.22.121-.22.271 0 .15.099.27.22.27h19.966c.121 0 .22-.12.22-.27 0-.15-.099-.271-.22-.271H36.535z"
                strokeWidth="0.2547"
                />
                <rect className="Astro-chart-el"
                x={29.402}
                y={13.262}
                width={1.551}
                height={0.542}
                rx={0.197}
                ry={0.585}
                strokeWidth="0.07904"
                />
                <rect className="Astro-chart-el"
                x={22.603}
                y={13.262}
                width={1.551}
                height={0.542}
                rx={0.197}
                ry={0.585}
                strokeWidth="0.07904"
                />
                <g>
                    <text y="87%" className="Astro-text">
                        <tspan x="20%" textAnchor="middle">{moonrise}</tspan>   
                    </text>
                </g>
                <g>
                    <text y="87%" className="Astro-text"> 
                        <tspan x="81%" textAnchor="middle">{moonset}</tspan>   
                    </text>
                </g>
                <g>
                    <text y="55%" className="Astro-text">
                        <tspan x="50%" textAnchor="middle">{moonDur}</tspan>   
                    </text>
                </g>
            </svg>
        </div>
    );
  }
  export default MoonChart;